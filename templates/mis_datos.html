{% extends "base.html" %}

{% block title %}Mis Datos Personales{% endblock %}

{% block content %}
<style>
    .profile-form-grid {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 20px 30px;
    }
    .form-section-title {
        grid-column: 1 / -1;
        margin-top: 20px;
        margin-bottom: 0;
        font-size: 1.1em;
        color: var(--primary-color);
        border-bottom: 1px solid #eee;
        padding-bottom: 10px;
    }
    .file-upload-section {
        grid-column: 1 / -1;
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 20px;
    }
    .file-upload-card {
        background-color: #fdfdff;
        border: 1px solid #e0e0e0;
        border-radius: var(--border-radius);
        padding: 20px;
        text-align: center;
    }
    .file-upload-card label {
        font-weight: 700;
    }
    .file-status {
        margin-top: 10px;
        font-size: 0.9em;
    }
</style>

<h2>Mis Datos Personales</h2>
<p style="text-align: center; margin-top: -15px; margin-bottom: 30px; color: var(--secondary-color);">Mantén tu información actualizada.</p>

<form method="POST" action="{{ url_for('mis_datos') }}">
    <div class="profile-form-grid">
        <h4 class="form-section-title">Información Personal</h4>
        <div class="form-group">
            <label for="nombre">Nombre(s)</label>
            <input type="text" id="nombre" name="nombre" value="{{ user.nombre or '' }}" required>
        </div>
        <div class="form-group">
            <label for="apellido">Apellido(s)</label>
            <input type="text" id="apellido" name="apellido" value="{{ user.apellido or '' }}" required>
        </div>
        <div class="form-group">
            <label for="correo_personal">Correo Personal</label>
            <input type="email" id="correo_personal" name="correo_personal" value="{{ user.correo_personal or '' }}">
        </div>
        <div class="form-group">
            <label for="email">Correo Corporativo (No editable)</label>
            <input type="email" id="email" name="email" value="{{ user.email }}" disabled>
        </div>
        <div class="form-group">
            <label for="tipo_documento">Tipo de Documento</label>
            <select id="tipo_documento" name="tipo_documento">
                <option value="" {% if not user.tipo_documento %}selected{% endif %}>-- Seleccionar --</option>
                <option value="DNI" {% if user.tipo_documento == 'DNI' %}selected{% endif %}>Documento Nacional de Identidad</option>
                <option value="PEP" {% if user.tipo_documento == 'PEP' %}selected{% endif %}>PEP</option>
                <option value="Pasaporte" {% if user.tipo_documento == 'Pasaporte' %}selected{% endif %}>Pasaporte</option>
                <option value="Otro" {% if user.tipo_documento == 'Otro' %}selected{% endif %}>Otro</option>
            </select>
        </div>
        <div class="form-group">
            <label for="numero_documento">Número de Documento</label>
            <input type="text" id="numero_documento" name="numero_documento" value="{{ user.numero_documento or '' }}">
        </div>
        <div class="form-group">
            <label for="numero_celular">Número Celular</label>
            <input type="tel" id="numero_celular" name="numero_celular" value="{{ user.numero_celular or '' }}" placeholder="+57 3001234567">
        </div>
        <div class="form-group">
            <label for="fecha_nacimiento">Fecha de Nacimiento</label>
            <input type="date" id="fecha_nacimiento" name="fecha_nacimiento" value="{{ user.fecha_nacimiento or '' }}">
        </div>
        <div class="form-group">
            <label for="pais_residencia">País de Residencia</label>
            <input type="text" id="pais_residencia" name="pais_residencia" value="{{ user.pais_residencia or '' }}">
        </div>
        <div class="form-group">
            <label for="ciudad_residencia">Ciudad de Residencia</label>
            <input type="text" id="ciudad_residencia" name="ciudad_residencia" value="{{ user.ciudad_residencia or '' }}">
        </div>

        <h4 class="form-section-title">Información Profesional</h4>
        <div class="form-group">
            <label for="fecha_ingreso">Fecha de Ingreso</label>
            <input type="date" id="fecha_ingreso" name="fecha_ingreso" value="{{ user.fecha_ingreso or '' }}">
        </div>
        <div class="form-group">
            <label for="linkedin_url">URL Perfil de LinkedIn</label>
            <input type="url" id="linkedin_url" name="linkedin_url" value="{{ user.linkedin_url or '' }}">
        </div>
        <div class="form-group">
            <label for="service">Service</label>
            <input type="text" id="service" name="service" value="{{ user.service or '' }}">
        </div>
        <div class="form-group">
            <label for="lob">LOB</label>
            <input type="text" id="lob" name="lob" value="{{ user.lob or '' }}">
        </div>
        <div class="form-group">
            <label for="cargo">Cargo</label>
            <input type="text" id="cargo" name="cargo" value="{{ user.cargo or '' }}">
        </div>
        <div class="form-group">
            <label for="tl">Team Lead (TL)</label>
            <input type="text" id="tl" name="tl" value="{{ user.tl or '' }}">
        </div>
        <div class="form-group">
            <label for="tm">Team Manager (TM)</label>
            <input type="text" id="tm" name="tm" value="{{ user.tm or '' }}">
        </div>
        <div class="form-group">
            <label for="estado_colaborador">Estado del Colaborador (Solo informativo)</label>
            <input type="text" id="estado_colaborador" name="estado_colaborador" value="{{ user.estado_colaborador or 'Activo' }}" disabled>
        </div>
         <div class="form-group" style="grid-column: 1 / -1;">
            <label>Equipo(s) (Solo informativo)</label>
            <input type="text" value="{% if user.teams %}{{ user.teams|map(attribute='name')|join(', ') }}{% else %}No asignado{% endif %}" disabled>
        </div>
    </div>

    <div style="text-align: center; margin-top: 30px;">
        <button type="submit">Guardar Cambios</button>
    </div>
</form>

<hr style="margin: 40px 0;">

<h3>Mis Documentos</h3>
<div class="file-upload-section">
    <div class="file-upload-card">
        <form method="POST" action="{{ url_for('upload_document', doc_type='identidad') }}" enctype="multipart/form-data">
            <label for="identidad_file">Documento de Identidad</label>
            <input type="file" name="file" id="identidad_file" accept=".pdf" required>
            <button type="submit" style="margin-top: 10px;">Subir</button>
        </form>
        <div class="file-status">
            {% if user.documento_identidad_file %}
                <p style="color: var(--success-color);">✔️ Cargado</p>
            {% else %}
                <p style="color: var(--danger-color);">❌ Pendiente</p>
            {% endif %}
        </div>
    </div>

    <div class="file-upload-card">
        <form method="POST" action="{{ url_for('upload_document', doc_type='bancario') }}" enctype="multipart/form-data">
            <label for="bancario_file">Certificado Cuenta Bancaria</label>
            <input type="file" name="file" id="bancario_file" accept=".pdf" required>
            <button type="submit" style="margin-top: 10px;">Subir</button>
        </form>
        <div class="file-status">
            {% if user.certificado_bancario_file %}
                <p style="color: var(--success-color);">✔️ Cargado</p>
            {% else %}
                <p style="color: var(--danger-color);">❌ Pendiente</p>
            {% endif %}
        </div>
    </div>

    <div class="file-upload-card">
        <form method="POST" action="{{ url_for('upload_document', doc_type='contrato') }}" enctype="multipart/form-data">
            <label for="contrato_file">Contrato</label>
            <input type="file" name="file" id="contrato_file" accept=".pdf" required>
            <button type="submit" style="margin-top: 10px;">Subir</button>
        </form>
        <div class="file-status">
            {% if user.contrato_file %}
                <p style="color: var(--success-color);">✔️ Cargado</p>
            {% else %}
                <p style="color: var(--danger-color);">❌ Pendiente</p>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}